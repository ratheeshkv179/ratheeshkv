# intersight - the PowerShell module for the Intersight REST API

This is Intersight REST API 

This PowerShell module is automatically generated by the [Swagger Codegen](https://github.com/swagger-api/swagger-codegen) project:

- API version: 1.0.9-706
- SDK version: 
- Build package: io.swagger.codegen.languages.PowerShellClientCodegen

<a name="frameworks-supported"></a>
## Frameworks supported
- PowerShell 3.0 or later

<a name="dependencies"></a>
## Dependencies
- C# API client generated by Swagger Codegen AND should be located in $ScriptDir\csharp\SwaggerClient as stated in Build.ps1

<a name="installation"></a>
## Installation
Run the following command to generate the DLL
- [Windows] `Build.ps1`

<a name="how- to write code using Powershell SDK"></a>
## Writing code using SDK
1. Import module from the .\src\intersight folder
```powershell
Import-Module .\src\intersight\intersight.psd1
```
2. Create IntersightApiClient

```powershell
New-IntersightApiClient $intersightUrl $private_key_path $api_key_id
```
   - **$intersightUrl** : URL of Intersight
     - Example : `$intersightUrl = "https://intersight.com/api/v1"`
   - **$private_key_path** : Location of .pem file saved for private key from Intersight UI
     - Example : `$private_key_path="C:\\Users\\ratkv\\source\\repos\\key.pem"`
   - **$api_key_id** : Api key id value from Intersight UI
     - Example : `$api_key_id="5a61b9896736327a31bbebff/5a61b7586736327a31bbeb74/5a7c3054647339736e57b82c"`

3. Sample scripts

- Create an LDAP policy
```powershell
	$ldap = New-IamLdapPolicy -Name "sample-ldap-policy" 
	Invoke-IamLdapPoliciesPost -body $ldap
```

- Update the field of an existing LDAP policy
```powershell
	$newLdap = New-IamLdapPolicy -Description "sample ldap policy"
	$Moid = ((Invoke-IamLdapPoliciesGet -filter "Name eq 'sample-ldap-policy'").Results[0]).Moid
	Invoke-IamLdapPoliciesMoidPatch -moid $Moid -body $newLdap
```

- Delete an LDAP policy
```powershell
	$Moid = ((Invoke-IamLdapPoliciesGet -filter "Name eq 'sample-ldap-policy'").Results[0]).Moid
	Invoke-IamLdapPoliciesMoidDelete -moid $Moid
```

- Check the number of LDAP policies created in InterSight
```powershell
	Invoke-IamLdapPoliciesGet -count $true | ConvertTo-Json
```

- Get the details of the LDAP policies created in InterSight
```powershell
	Invoke-IamLdapPoliciesGet -inlinecount "allpages" | ConvertTo-Json
```

- Filter LDAP policies
```powershell
	Invoke-IamLdapPoliciesGet -filter "Name eq 'sample-ldap-policy'" | ConvertTo-Json
	Invoke-IamLdapPoliciesGet -filter "Description eq 'sample ldap policy'"| ConvertTo-Json	
``` 

- Get the first LDAP MO in the list
```powershell
	Invoke-IamLdapPoliciesGet -top 1 | ConvertTo-Json
``` 


- Get LDAP policies MO details with Name and Moid fields
```powershell
	Invoke-IamLdapPoliciesGet  -select "Name,Moid" | ConvertTo-Json
``` 

- Get LDAP policies MO based on ordering it's field
```powershell
	Invoke-IamLdapPoliciesGet  -orderby "Name asc" | ConvertTo-Json
	Invoke-IamLdapPoliciesGet  -orderby "Name desc" | ConvertTo-Json
``` 

- Use this link : https://www.odata.org/documentation/odata-version-2-0/uri-conventions/, for using options in the GET requests of cmdlets


4. Help

- Seach for help
```powershell
- Get-Help <cmdlet> -Detailed
- Get-Help <cmdlet> -Full
```

